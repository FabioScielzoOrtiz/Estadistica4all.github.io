--- 
title: "Introduction to SQL in Azure Data Studio"
author: "Fabio Scielzo Ortiz"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: book.bib
description: |
  This article is an introduction to SQL in Azure Data Studio.
link-citations: yes
github-repo: "rstudio/bookdown-demo"
---

# Introduction  


<center>

![](SQL_intro.jpg){width="45%"}

</center>


<br>


<div class="warning" style='background-color:#FCF2EC; color: #000000; border-left: solid #FE9554 7px; border-radius: 3px; size:1px ; padding:0.1em;'>
<span>
 
<p style='margin-left:10em;'>


- **More articles:    $\hspace{0.1cm}$ [Estadistica4all](https://estadistica4all.com/)**

- **Author:** $\hspace{0.1cm}$ [Fabio Scielzo Ortiz](https://estadistica4all.com/creador.html)

- **If you use this article, please cite it:**

$\hspace{1.2cm}$ Scielzo Ortiz, F. (2023). Introducción a Pandas. Estadistica4all. 


- ***It is recommended to open the article on a computer or tablet.***

</p>
 
</p></span>
</div>


 <br>
 
 
This article is an introduction to **SQL** in **Azure Data Studio**.
 
 
 <br>
 

# Install Azure Data Studio    



- First, we need to download Azure Data Studio. It can be done easily from the following [link](https://learn.microsoft.com/es-es/sql/azure-data-studio/download-azure-data-studio?view=sql-server-ver16)

- You also need to download SQL Server 2019 Developer Edition. We can do that from the following [link](https://www.microsoft.com/es-es/sql-server/sql-server-downloads?rtc=1).



- Once we have successfully installed both programs, we open Azure Data Studio.

 

    We will find a screen similar to the following:

<center>

![](p1.jpg){width="100%"}

</center> 
 
<br>

- We must establish a connection with the server, to be able to work with databases. In our case it will be a server hosted on our local computer. To establish the connection we must click on the yellow part.

    After clicking on it, we will find a screen similar to the following:

<center>

![](p2.jpg){width="100%"}

</center> 
 

<br>

- We must fill the Server field with "localhost", as shown in the following image:


<center>

![](p3.jpg){width="50%"}

</center> 


<br>

- Then a message like this will be displayed. We click on the blue button (Enable trusted server certificate):

<center>

![](p4.jpg){width="100%"}

</center> 


<br>

- If the server has connected successfully, the screen will show something like this:


<center>

![](p5.jpg){width="100%"}

</center> 


<br>


- Clicking on New Query, It will open an SQL script where we can start working with SQL.

 

<br>


# Create a database


- We are going to create a new database, which will be called **Base_Datos_Fabio**:



<center>

![](p6.jpg){width="100%"}

</center> 


<br>

The code used to create the new database is the following:


```sql
USE master
GO
IF NOT EXISTS (
 SELECT name
 FROM sys.databases
 WHERE name = N'Base_Datos_Fabio'
)
 CREATE DATABASE [Base_Datos_Fabio];
GO
IF SERVERPROPERTY('ProductVersion') > '12'
 ALTER DATABASE [Base_Datos_Fabio] SET QUERY_STORE=ON;
GO
```

<br>

After the execution of the above SQL code, the database should be created, and it should appear on the left side of the environment, as shown in the following image:

 
<center>

![](p7.jpg){width="100%"}

</center> 


<br>


# Delete a database

We can delete a database as follows:

```sql
-- Drop the database 'Base_Datos_Fabio'
-- Connect to the 'master' database to run this snippet
USE master
GO
-- Uncomment the ALTER DATABASE statement below to set the database to SINGLE_USER mode if the drop database command fails because the database is in use.
ALTER DATABASE Base_Datos_Fabio SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
-- Drop the database if it exists
IF EXISTS (
  SELECT [name]
   FROM sys.databases
   WHERE [name] = N'Base_Datos_Fabio'
)
DROP DATABASE Base_Datos_Fabio
GO
```


<br>



# Create a table

Now we are going to create a new table inside the database that we have just defined.

To do this, the same SQL script can be used but modifying the element indicated at the top of the screen. This element allows us to set the database in which we are going to make the changes.

In this case we select the database **Base_Datos_Fabio**, which is the one we created in the previous step.

<center>

![](p8.jpg){width="100%"}

</center> 

<br>

The code used to create the new table is the following:

```sql
-- Create a new table called 'Alumnos' in schema 'dbo'
-- Drop the table if it already exists
IF OBJECT_ID('dbo.Alumnos', 'U') IS NOT NULL
 DROP TABLE dbo.Alumnos;
GO
-- Create the table in the specified schema
CREATE TABLE dbo.Alumnos
(
 ClienteId nvarchar(50) NOT NULL PRIMARY KEY, 
 Nombre char (50) NOT NULL,
 Pais nvarchar(50) NOT NULL,
 Ciudad nvarchar(50) NOT NULL,
 Email nvarchar (50) NOT NULL,
 Telefono  nvarchar (50) NOT NULL
);
GO
```

<br>

We execute the last code and check if the table **Alumnos** has been created inside **Base_Datos_Fabio**:

<center>

![](p9.jpg){width="100%"}

</center> 


<br>


From now on, all the operations we do with SQL code will be executed from a SQL script within the Azure Data Studio environment, but no more screenshots will be shown about it. 

What we will do is show the code that must be executed each time and the outputs that are obtained after its execution.



We are going to create two more tables (**Profesores** and **Examenes**) inside the database **Base_Datos_Fabio**.

The code used to create them is as follows:

```sql
IF OBJECT_ID('dbo.Profesores', 'U') IS NOT NULL
 DROP TABLE dbo.Profesores;
GO
-- Create the table in the specified schema
CREATE TABLE dbo.Profesores
(
 ProfesorId nvarchar (50) NOT NULL PRIMARY KEY, -- primary key column
 Nombre nvarchar (50) NOT NULL,
 Estudios nvarchar(50) NOT NULL,
 Email nvarchar(50) NOT NULL,
);
GO
```


```sql
IF OBJECT_ID('dbo.Examenes', 'U') IS NOT NULL
 DROP TABLE dbo.Examenes;
GO
-- Create the table in the specified schema
CREATE TABLE dbo.Examenes
(
 ExamenId nvarchar (50) NOT NULL PRIMARY KEY, -- primary key column
 Nota DECIMAL(5,2) NOT NULL,
 Asignatura nvarchar (50) NOT NULL,
 AlumnoID nvarchar (50) NOT NULL,
 ProfesorID  nvarchar (50) NOT NULL
);
GO
```

<br>

## Primary Key 

The **PRIMARY KEY** statement is associated with columns that are unique identifiers.

If the **PRIMARY KEY** statement is attached to a column, it prevents repeating values in that column.

These types of columns are essential in databases since they will allow joining tables through different operations that will be seen later.

<br>

## Not Null and Null

If the **NOT NULL** statement is associated with a column, it prevents this column from having null values.

If the **NULL** statement is associated with a column, it allows this column to have null values.


<br>


# Insert rows into a table

Inserting rows into **Alumnos** table:

```sql
INSERT INTO dbo.Alumnos
 ([AlumnoID], [Nombre], [Pais], [Ciudad], [Email], [Telefono])
VALUES
 ( 'A1', N'Orlando', N'Australia', N'', N'' , N'917755028'),
 ( 'A2', N'Keith', N'India', N'', N'keith0@adventure-works.com', N''),
 ( 'A3', N'Donna', N'Germany', N'Berlin', N'donna0@adventure-works.com', N'915547890'),
 ( 'A4', N'Janet', N'United States', N'California',  N'janet1@adventure-works.com', N''),
 ( 'A5', N'Fabio', N'España', N'Madrid', N'fabio10@gmail.com', N''),
 ( 'A6', N'Juan', N'España', N'Sevilla', N'' , N'915869028'),
 ( 'A7', N'Lucia', N'España', N'', N'LuciaPerez@hotmail.com', N''),
 ( 'A8', N'Pedro', N'Italia', N'Roma', N'Pedro99@gmail.com', N'910007890'),
 ( 'A9', N'Sergio', N'United States', N'New York',  N'sergio_as@gmail.com', N''),
 ( 'A10', N'Grecia', N'Peru', N'Lima', N'Grecia89@gmail.com', N''),
 ( 'A11', N'Ismael', N'España', N'Madrid', N'Isma98@gmail.com', N'912234543'),
 ( 'A12', N'Luis', N'España', N'Murcia', N'Luismiguel123@gmail.com', N''),
 ( 'A13', N'Pedro', N'Argentina', N'Buenos Aires', N'Pedro120@gmail.com', N'')
GO
```

|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A1|Orlando                                           |Australia|||917755028|
|A10|Grecia                                            |Peru|Lima|Grecia89@gmail.com||
|A11|Ismael                                            |Espa&#241;a|Madrid|Isma98@gmail.com|912234543|
|A12|Luis                                              |Espa&#241;a|Murcia|Luismiguel123@gmail.com||
|A13|Pedro                                             |Argentina|Buenos Aires|Pedro120@gmail.com||
|A2|Keith                                             |India||keith0@adventure-works.com||
|A3|Donna                                             |Germany|Berlin|donna0@adventure-works.com|915547890|
|A4|Janet                                             |United States|California|janet1@adventure-works.com||
|A5|Fabio                                             |Espa&#241;a|Madrid|fabio10@gmail.com||
|A6|Juan                                              |Espa&#241;a|Sevilla||915869028|
|A7|Lucia                                             |Espa&#241;a||LuciaPerez@hotmail.com||
|A8|Pedro                                             |Italia|Roma|Pedro99@gmail.com|910007890|
|A9|Sergio                                            |United States|New York|sergio_as@gmail.com||



<br>

Inserting rows into **Profesores** table:


```sql
INSERT INTO dbo.Profesores
 ([ProfesorID], [Nombre], [Estudios], [Email])
VALUES
 ( 'P1', N'Juan', N'Matemáticas', N'JuanPerez@colegio.es'),
 ( 'P2', N'Sonia', N'Física', N'SoniDiaz@colegio.es'),
 ( 'P3', N'Lucia', N'Lengua', N'LuciaPerez@colegio.es'),
  ( 'P4', N'Marcos', N'Biología', N'MarcosSanz@colegio.es'),
 ( 'P5', N'Carlos', N'Educación Física', N'CarlosFernandez@colegio.es'),
 ( 'P6', N'Daniel', N'Geografía', N'DanielOrtiz@colegio.es'),
 ( 'P7', N'Garazi', N'Inglés', N'GaraziGarcia@colegio.es')
GO
```
|ProfesorID|Nombre|Estudios|Email|
|:---|:---|:---|:---|
|P1|Juan|Matem&#225;ticas|JuanPerez@colegio.es|
|P2|Sonia|F&#237;sica|SoniDiaz@colegio.es|
|P3|Lucia|Lengua|LuciaPerez@colegio.es|
|P4|Marcos|Biolog&#237;a|MarcosSanz@colegio.es|
|P5|Carlos|Educaci&#243;n F&#237;sica|CarlosFernandez@colegio.es|
|P6|Daniel|Geograf&#237;a|DanielOrtiz@colegio.es|
|P7|Garazi|Ingl&#233;s|GaraziGarcia@colegio.es|




<br>

Inserting rows into **Examenes** table:

```sql
INSERT INTO dbo.Examenes
 ([ExamenID], [Nota], [Asignatura], [AlumnoID], [ProfesorID])
VALUES
 ( 'E1', 6.7, N'Matemáticas', N'A2', N'P1'),
 ( 'E2', 8, N'Física', N'A4', N'P2'),
 ( 'E3', 4.25, N'Matemáticas', N'A1', N'P1'),
 ( 'E4', 6.5, N'Inglés', N'A7', N'P7'),
 ( 'E5', 7, N'Lengua', N'A9', N'P3')
GO
```

|ExamenID|Nota|Asignatura|AlumnoID|ProfesorID|
|:---|:---|:---|:---|:---|
|E1|6.70|Matem&#225;ticas|A2|P1|
|E2|8.00|F&#237;sica|A4|P2|
|E3|4.25|Matem&#225;ticas|A1|P1|
|E4|6.50|Inglés|A7|P7|
|E5|7.00|Lengua|A9|P3|


<br>



## Cheking Primary Key restriction

```sql
INSERT INTO dbo.Profesores
 ([ProfesorID], [Nombre], [Estudios], [Email])
VALUES
 ( 'P1' , N'Juan', N'Filosofía', N'JuanDiaz@colegio.es')
GO
```

```
Infracción de la restricción PRIMARY KEY 'PK__Profesor__4DF3F028228525F7'. No se puede insertar una clave duplicada en el objeto 'dbo.Profesores'. El valor de la clave duplicada es (P1).
```

<br>


## Checking Not Null restriction



```sql
INSERT INTO dbo.Profesores
 ([ProfesorID], [Nombre], [Estudios], [Email])
VALUES
 ( 'P8' , NULL, N'Filosofía', N'JuanDiaz@colegio.es')
GO
```

```
No se puede insertar el valor NULL en la columna 'Nombre', tabla 'Base_Datos_Fabio.dbo.Profesores'. La columna no admite valores NULL. Error de INSERT.
```


<br>


# Import a CSV as table

First of all, we must intall the **SQL Server Import** Azure Data Studio extension. 



<center>

![](p13.png){width="100%"}

</center> 


<br>

Next we import a CSV following the following steps:


<center>

![](p14.png){width="100%"}

</center> 


<center>

![](p15.png){width="100%"}

</center> 


<center>

![](p16.png){width="100%"}

</center> 



<center>

![](p17.png){width="100%"}

</center> 



<br>


# Full view of a table


We can do a full view of a table as follows:

```sql
SELECT * FROM Alumnos;
```

|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|---|---|---|---|---|---|
|A1|Orlando                                           |Australia|||917755028|
|A10|Grecia                                            |Peru|Lima|Grecia89@gmail.com||
|A11|Ismael                                            |Espa&#241;a|Madrid|Isma98@gmail.com|912234543|
|A12|Luis                                              |Espa&#241;a|Murcia|Luismiguel123@gmail.com||
|A13|Pedro                                             |Argentina|Buenos Aires|Pedro120@gmail.com||
|A2|Keith                                             |India||keith0@adventure-works.com||
|A3|Donna                                             |Germany|Berlin|donna0@adventure-works.com|915547890|
|A4|Janet                                             |United States|California|janet1@adventure-works.com||
|A5|Fabio                                             |Espa&#241;a|Madrid|fabio10@gmail.com||
|A6|Juan                                              |Espa&#241;a|Sevilla||915869028|
|A7|Lucia                                             |Espa&#241;a||LuciaPerez@hotmail.com||
|A8|Pedro                                             |Italia|Roma|Pedro99@gmail.com|910007890|
|A9|Sergio                                            |United States|New York|sergio_as@gmail.com||




<br>

# Number of columns

We can get the number of columns of a table as follows:

```sql
SELECT count(*) 
FROM information_schema.columns 
WHERE table_name ='House_Price_Regression';
```

|Number of columns|
|:---|
|29|




<br>

# Number of rows

We can get the number of rows of a table as follows:

```sql
SELECT COUNT(*) FROM House_Price_Regression;
```

|Number of rows|
|:---|
|1905|



<br>

# Head of a table

We can get the first rows of a table as follows:

```sql
SELECT TOP (4) [neighborhood_recode]
       [price]
      ,[no_of_bedrooms]
      ,[no_of_bathrooms]
      ,[quality_recode]
      ,[size_in_m_2]
  FROM [Base_Datos_Fabio].[dbo].[House_Price_Regression]
```


|price|no_of_bedrooms|no_of_bathrooms|quality_recode|size_in_m_2|
|:---|:---|:---|:---|:---|
|460|1|2|20|100242337|
|460|2|2|20|146972546|
|360|3|5|20|181253753|
|110|2|3|10|18766406|



<br>


# Select columns  from a table


We can select columns from a table as follows:

```SQL
SELECT Nombre, Pais, Ciudad FROM dbo.Alumnos;
```

 
 |Nombre|Pais|Ciudad|
|:---|:---|:---|
|Orlando                                           |Australia||
|Grecia                                            |Peru|Lima|
|Ismael                                            |Espa&#241;a|Madrid|
|Luis                                              |Espa&#241;a|Murcia|
|Pedro                                             |Argentina|Buenos Aires|
|Keith                                             |India||
|Donna                                             |Germany|Berlin|
|Janet                                             |United States|California|
|Fabio                                             |Espa&#241;a|Madrid|
|Juan                                              |Espa&#241;a|Sevilla|
|Lucia                                             |Espa&#241;a||
|Pedro                                             |Italia|Roma|
|Sergio                                            |United States|New York|

 
 
 <br>
 
Another example:

```sql
SELECT quality_recode, balcony_recode,size_in_m_2, private_jacuzzi_recode FROM House_Price_Regression
```
 
|quality_recode|balcony_recode|size_in_m_2|private_jacuzzi_recode|
|:---|:---|:---|:---|
|20|10|100242337|0| 
|20|10|146972546|0| 
|20|10|181253753|10| 
|10|10|18766406|0| 
|20|0|47101821|0| 
|20|0|94296545|0| 
|0|0|191565986|0| 
|20|0|94296545|0| 
|10|0|203085958|0| 
|20|10|141305463|0|
|10|10|178187954|0|
|10|10|98291374|0| 
|10|0|56577927|0| 
|...|...|...|...| 
 
 
 
<br>


# Assign alias to a column


We can assign a name (alias) to a column as follows:

```SQL
SELECT Nombre AS Nombre_Alumnos
FROM dbo.Alumnos;
```
 
|Nombre_Alumnos|
|:---|
|Orlando                                           |
|Grecia                                            |
|Ismael                                            |
|Luis                                              |
|Pedro                                             |
|Keith                                             |
|Donna                                             |
|Janet                                             |
|Fabio                                             |
|Juan                                              |
|Lucia                                             |
|Pedro                                             |
|Sergio                                            |

 
 
 
 
 
<br>

# Filter rows from a table

We can filter rows from a table in different ways.


## Filtering rows by conditions


Filtering rows from **Examenes** table where **Nota** column is less than 7 :

```sql
SELECT * FROM dbo.Examenes WHERE Nota < 7 ;
```
|ExamenID|Nota|Asignatura|AlumnoID|ProfesorID|
|:---|:---|:---|:---|:---|
|E1|6.70|Matem&#225;ticas|A2|P1|
|E3|4.25|Matem&#225;ticas|A1|P1|
|E4|6.50|Matem&#225;ticas|A7|P7|
 


<br>

Filtering rows  from **Examenes** table where **Nota** column is less or equal than 7 :

```sql
SELECT * FROM dbo.Examenes WHERE Nota <= 7 ;
```

|ExamenID|Nota|Asignatura|AlumnoID|ProfesorID|
|:---|:---|:---|:---|:---|
|E1|6.70|Matem&#225;ticas|A2|P1|
|E3|4.25|Matem&#225;ticas|A1|P1|
|E4|6.50|Inglés|A7|P7|
|E5|7.00|Lengua|A9|P3|


<br>

Filtering rows  from **Examenes** table where **Nota** column is less than 7 , and only **AlumnoID** and **Nota** columns are displayed :

```sql
SELECT AlumnoID, Nota FROM dbo.Examenes WHERE Nota < 7 ;
```

|AlumnoID|Nota|
|:---|:---|
|A2|6.70|
|A1|4.25|
|A7|6.50|


<br>

Filtering rows  from **Alumnos** table where **Nombre** column is equal to 'Fabio' :

```sql
SELECT * FROM dbo.Alumnos WHERE Nombre = 'Fabio';
```

|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A5|Fabio |Espa&#241;a|Madrid|fabio10@gmail.com||


<br>

Filtering rows  from **Alumnos** table where **Nombre** column is not equal to 'Fabio':

```sql
SELECT * FROM dbo.Alumnos WHERE Nombre != 'Fabio';
```

|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A1|Orlando                                           |Australia|||917755028|
|A10|Grecia                                            |Peru|Lima|Grecia89@gmail.com||
|A11|Ismael                                            |Espa&#241;a|Madrid|Isma98@gmail.com|912234543|
|A12|Luis                                              |Espa&#241;a|Murcia|Luismiguel123@gmail.com||
|A13|Pedro                                             |Argentina|Buenos Aires|Pedro120@gmail.com||
|A2|Keith                                             |India||keith0@adventure-works.com||
|A3|Donna                                             |Germany|Berlin|donna0@adventure-works.com|915547890|
|A4|Janet                                             |United States|California|janet1@adventure-works.com||
|A6|Juan                                              |Espa&#241;a|Sevilla||915869028|
|A7|Lucia                                             |Espa&#241;a||LuciaPerez@hotmail.com||
|A8|Pedro                                             |Italia|Roma|Pedro99@gmail.com|910007890|
|A9|Sergio                                            |United States|New York|sergio_as@gmail.com||


<br>

Filtering rows from **Alumnos** table where **Nombre** column is equal to 'Fabio' or 'Pedro' :

```sql
SELECT * FROM dbo.Alumnos WHERE Nombre in ('Fabio','Pedro');
```

|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A13|Pedro                                             |Argentina|Buenos Aires|Pedro120@gmail.com||
|A5|Fabio                                             |Espa&#241;a|Madrid|fabio10@gmail.com||
|A8|Pedro                                             |Italia|Roma|Pedro99@gmail.com|910007890|



<br>

Filtering rows from **Alumnos** table where **Nombre** column is different to 'Fabio' and 'Pedro' :

```sql
SELECT * FROM dbo.Alumnos WHERE Nombre not in ('Fabio','Pedro');
```

|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A1|Orlando                                           |Australia|||917755028|
|A10|Grecia                                            |Peru|Lima|Grecia89@gmail.com||
|A11|Ismael                                            |Espa&#241;a|Madrid|Isma98@gmail.com|912234543|
|A12|Luis                                              |Espa&#241;a|Murcia|Luismiguel123@gmail.com||
|A2|Keith                                             |India||keith0@adventure-works.com||
|A3|Donna                                             |Germany|Berlin|donna0@adventure-works.com|915547890|
|A4|Janet                                             |United States|California|janet1@adventure-works.com||
|A6|Juan                                              |Espa&#241;a|Sevilla||915869028|
|A7|Lucia                                             |Espa&#241;a||LuciaPerez@hotmail.com||
|A9|Sergio                                            |United States|New York|sergio_as@gmail.com||


<br>

Filtering rows from **Examenes** table where **Nota** column is less than 7 and greater than 5, and only **AlumnoID**, **Nota** and **ProfesorID** columns are displayed :

```sql
SELECT AlumnoID , Nota, ProfesorID FROM dbo.Examenes WHERE Nota < 7 AND Nota > 5 ;
```

|AlumnoID|Nota|ProfesorID|
|:---|:---|:---|
|A2|6.70|P1|
|A7|6.50|P7|



<br>

Filtering rows from **Profesores** table where **Estudios** column is equal to 'Inglés' or 'Geografía', and only **Nombre** column is displayed :

```sql
SELECT Nombre FROM dbo.Profesores WHERE Estudios = 'Inglés' OR Estudios = 'Geografía' ;
```

|Nombre|
|:---|
|Daniel|
|Garazi|


<br>
 

Filtering rows from **Alumnos** table where **Nombre** column is nor null :

```sql
SELECT*FROM Alumnos WHERE Nombre is NOT NULL
```
|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A1|Orlando                                           |Australia|||917755028|
|A10|Grecia                                            |Peru|Lima|Grecia89@gmail.com||
|A11|Ismael                                            |Espa&#241;a|Madrid|Isma98@gmail.com|912234543|
|A12|Luis                                              |Espa&#241;a|Murcia|Luismiguel123@gmail.com||
|A13|Pedro                                             |Argentina|Buenos Aires|Pedro120@gmail.com||
|A2|Keith                                             |India||keith0@adventure-works.com||
|A3|Donna                                             |Germany|Berlin|donna0@adventure-works.com|915547890|
|A4|Janet                                             |United States|California|janet1@adventure-works.com||
|A5|Fabio                                             |Espa&#241;a|Madrid|fabio10@gmail.com||
|A6|Juan                                              |Espa&#241;a|Sevilla||915869028|
|A7|Lucia                                             |Espa&#241;a||LuciaPerez@hotmail.com||
|A8|Pedro                                             |Italia|Roma|Pedro99@gmail.com|910007890|
|A9|Sergio                                            |United States|New York|sergio_as@gmail.com||

 
<br>


## Select rows with strings with Like and Not Like


Filtering rows from **Alumnos** table where **Nombre** column contains  the string 'io' :

```sql
SELECT * FROM Alumnos WHERE Nombre like '%io%' ;
```

|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A5|Fabio                                             |Espa&#241;a|Madrid|fabio10@gmail.com||
|A9|Sergio                                            |United States|New York|sergio_as@gmail.com||

 



<br>

Filtering rows from **Alumnos** table where **Nombre** column starts by the string 'o' :

```SQL
SELECT * FROM Alumnos WHERE Nombre like 'o%' ; -- starts by 'o'
```

|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A1|Orlando                                           |Australia|||917755028|

 

<br>

Filtering rows from **Alumnos** table where **Nombre** column ends by the string 'o' :

```SQL
SELECT * FROM Alumnos WHERE Nombre like '%o' ; -- ends by 'o'
```
 
|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A1|Orlando                                           |Australia|||917755028|
|A13|Pedro                                             |Argentina|Buenos Aires|Pedro120@gmail.com||
|A5|Fabio                                             |Espa&#241;a|Madrid|fabio10@gmail.com||
|A8|Pedro                                             |Italia|Roma|Pedro99@gmail.com|910007890|
|A9|Sergio                                            |United States|New York|sergio_as@gmail.com||




<br>


Filtering rows from **Alumnos** table where **Nombre** column contains the string 'ab' an ends by 'o' :

```SQL
SELECT * FROM Alumnos WHERE Nombre like '%ab%o' ; -- has 'ab' and ends by 'o'
```

|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A5|Fabio                                             |Espa&#241;a|Madrid|fabio10@gmail.com||




<br>


Filtering rows from **Alumnos** table where **Nombre** column starts with 'F' followed by 4 characters :

```sql
SELECT * FROM dbo.Alumnos WHERE Nombre like '%F____' ; -- starts with 'F' followed by 4 characters
```

|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A5|Fabio                                             |Espa&#241;a|Madrid|fabio10@gmail.com||




<br>

Filtering rows from **Alumnos** table where **Nombre** column starts with 'F' followed by 2 characters :

```sql
SELECT * FROM dbo.Clientes WHERE Nombre like '%F__' ; -- empieza por 'F' seguida de 2 caracteres
```
 
|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
 

 
 
<br>

 

# Creating a new table based on a query


We can create a new table based on a query as follows :

```sql
SELECT  Nombre, Email 
INTO New_Table 
FROM Alumnos ;
```

```sql
SELECT*FROM New_Table ;
```

|Nombre|Email|
|:---|:---|
|Orlando                                           ||
|Grecia                                            |Grecia89@gmail.com|
|Ismael                                            |Isma98@gmail.com|
|Luis                                              |Luismiguel123@gmail.com|
|Pedro                                             |Pedro120@gmail.com|
|Keith                                             |keith0@adventure-works.com|
|Donna                                             |donna0@adventure-works.com|
|Janet                                             |janet1@adventure-works.com|
|Fabio                                             |fabio10@gmail.com|
|Juan                                              ||
|Lucia                                             |LuciaPerez@hotmail.com|
|Pedro                                             |Pedro99@gmail.com|
|Sergio                                            |sergio_as@gmail.com|



<br>
 

# Delete rows from a table

We can delete all the rows from a table as follows : 

```sql
DELETE from Alumnos
```


```sql
SELECT * FROM Alumnos
```
|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|---|---|---|---|---|---|



<br>

# Delete rows from a table that meet a condition

We can also delete rows from a table that meet a specific condition as follows:

```sql
Delete from Alumnos WHERE Nombre = 'Fabio'
```

```sql
SELECT * FROM Alumnos
```
|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A1|Orlando                                           |Australia|||917755028|
|A10|Grecia                                            |Peru|Lima|Grecia89@gmail.com||
|A11|Ismael                                            |Espa&#241;a|Madrid|Isma98@gmail.com|912234543|
|A12|Luis                                              |Espa&#241;a|Murcia|Luismiguel123@gmail.com||
|A13|Pedro                                             |Argentina|Buenos Aires|Pedro120@gmail.com||
|A2|Keith                                             |India||keith0@adventure-works.com||
|A3|Donna                                             |Germany|Berlin|donna0@adventure-works.com|915547890|
|A4|Janet                                             |United States|California|janet1@adventure-works.com||
|A6|Juan                                              |Espa&#241;a|Sevilla||915869028|
|A7|Lucia                                             |Espa&#241;a||LuciaPerez@hotmail.com||
|A8|Pedro                                             |Italia|Roma|Pedro99@gmail.com|910007890|
|A9|Sergio                                            |United States|New York|sergio_as@gmail.com||





<br>


```sql
Delete from Alumnos WHERE Nombre in ('Fabio','Grecia', 'Orlando')
```
```sql
SELECT * FROM Alumnos
```


|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A11|Ismael                                            |Espa&#241;a|Madrid|Isma98@gmail.com|912234543|
|A12|Luis                                              |Espa&#241;a|Murcia|Luismiguel123@gmail.com||
|A13|Pedro                                             |Argentina|Buenos Aires|Pedro120@gmail.com||
|A2|Keith                                             |India||keith0@adventure-works.com||
|A3|Donna                                             |Germany|Berlin|donna0@adventure-works.com|915547890|
|A4|Janet                                             |United States|California|janet1@adventure-works.com||
|A6|Juan                                              |Espa&#241;a|Sevilla||915869028|
|A7|Lucia                                             |Espa&#241;a||LuciaPerez@hotmail.com||
|A8|Pedro                                             |Italia|Roma|Pedro99@gmail.com|910007890|
|A9|Sergio                                            |United States|New York|sergio_as@gmail.com||




# Delete columns from a table

We can delete specific columns from a table as follows : 

```sql 
ALTER TABLE dbo.Alumnos DROP COLUMN Nombre , Email;
```

```sql
SELECT * FROM Alumnos
```

|AlumnoID|Pais|Ciudad|Telefono|
|:---|:---|:---|:---|
|A11|Espa&#241;a|Madrid|912234543|
|A12|Espa&#241;a|Murcia||
|A13|Argentina|Buenos Aires||
|A2|India|||
|A3|Germany|Berlin|915547890|
|A4|United States|California||
|A6|Espa&#241;a|Sevilla|915869028|
|A7|Espa&#241;a|||
|A8|Italia|Roma|910007890|
|A9|United States|New York||


<br>

# Delete a table

We can completely delete a table as follows :

```sql
DROP TABLE Alumnos 
```




 


<br>


# Update columns of a table

We can update a column for specific rows that meet a condition as follows :

```sql
UPDATE Alumnos  set  Nombre = 'Messi' WHERE AlumnoID = 'A2'
```
 
```sql
SELECT * FROM Alumnos
```
|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A1|Orlando                                           |Australia|||917755028|
|A10|Grecia                                            |Peru|Lima|Grecia89@gmail.com||
|A11|Ismael                                            |Espa&#241;a|Madrid|Isma98@gmail.com|912234543|
|A12|Luis                                              |Espa&#241;a|Murcia|Luismiguel123@gmail.com||
|A13|Pedro                                             |Argentina|Buenos Aires|Pedro120@gmail.com||
|A2|Messi                                             |India||keith0@adventure-works.com||
|A3|Donna                                             |Germany|Berlin|donna0@adventure-works.com|915547890|
|A4|Janet                                             |United States|California|janet1@adventure-works.com||
|A5|Fabio                                             |Espa&#241;a|Madrid|fabio10@gmail.com||
|A6|Juan                                              |Espa&#241;a|Sevilla||915869028|
|A7|Lucia                                             |Espa&#241;a||LuciaPerez@hotmail.com||
|A8|Pedro                                             |Italia|Roma|Pedro99@gmail.com|910007890|
|A9|Sergio                                            |United States|New York|sergio_as@gmail.com||



<br>

We can update all the values in a column as follows :

```sql
UPDATE Alumnos set Nombre = 'Messi' 
```
 
```sql
SELECT * FROM Alumnos
```

|AlumnoID|Nombre|Pais|Ciudad|Email|Telefono|
|:---|:---|:---|:---|:---|:---|
|A1|Messi                                             |Australia|||917755028|
|A10|Messi                                             |Peru|Lima|Grecia89@gmail.com||
|A11|Messi                                             |Espa&#241;a|Madrid|Isma98@gmail.com|912234543|
|A12|Messi                                             |Espa&#241;a|Murcia|Luismiguel123@gmail.com||
|A13|Messi                                             |Argentina|Buenos Aires|Pedro120@gmail.com||
|A2|Messi                                             |Argentina||keith0@adventure-works.com||
|A3|Messi                                             |Germany|Berlin|donna0@adventure-works.com|915547890|
|A4|Messi                                             |United States|California|janet1@adventure-works.com||
|A5|Messi                                             |Espa&#241;a|Madrid|fabio10@gmail.com||
|A6|Messi                                             |Espa&#241;a|Sevilla||915869028|
|A7|Messi                                             |Espa&#241;a||LuciaPerez@hotmail.com||
|A8|Messi                                             |Italia|Roma|Pedro99@gmail.com|910007890|
|A9|Messi                                             |United States|New York|sergio_as@gmail.com||
 


<br>


## Setting a default value for a column

We can set a default value for a column when the 'DEFAULT' value is inserted : 

```sql
IF OBJECT_ID('dbo.Otra_Tabla_1', 'U') IS NOT NULL
 DROP TABLE dbo.Otra_Tabla_1;
GO
CREATE TABLE dbo.Otra_Tabla_1
(
 Id nvarchar (50) NOT NULL PRIMARY KEY, 
 Nombre nvarchar (50) NOT NULL,
 Email nvarchar(50) NOT NULL DEFAULT 'no tiene',
 Telefono nvarchar (50) NOT NULL DEFAULT 'desconocido'
);
GO
```

```sql
INSERT INTO dbo.Otra_Tabla_1
 ([Id], [Nombre], [Email], [Telefono])
VALUES
 ( 1 , 'Juan', DEFAULT , DEFAULT),
 ( 2 , 'Rodrigo', DEFAULT , '915568799'),
 ( 3 , 'Sofia', DEFAULT , DEFAULT),
 ( 4 , 'Irene', 'Irene99@hotmail.es' , '914478236'),
 ( 5 , 'Luis', 'LuisMP@gmail.com' , DEFAULT)
GO 
```


|Id|Nombre|Email|Telefono|
|:---|:---|:---|:---|
|1|Juan|no tiene|desconocido|
|2|Rodrigo|no tiene|915568799|
|3|Sofia|no tiene|desconocido|
|4|Irene|Irene99@hotmail.es|914478236|
|5|Luis|LuisMP@gmail.com|desconocido|


<br>



# Columns calculated from others



```sql
IF OBJECT_ID('dbo.Ventas', 'U') IS NOT NULL
 DROP TABLE dbo.Ventas;
GO
CREATE TABLE dbo.Ventas
(
 VentasId nvarchar (50) NOT NULL PRIMARY KEY, 
 Producto char (50) NOT NULL,
 Precio float (50) NOT NULL,
 Descuento float (50) NOT NULL,
 Cliente nvarchar (50) NOT NULL,
 Proveedor  nvarchar (50) NOT NULL
);
GO

-- Insert rows
INSERT INTO dbo.Ventas
 ([VentasId], [Producto], [Precio], [Descuento], [Cliente], [Proveedor])
VALUES
 ( 'V1', 'Alfombra', 1500, 0.5 ,'C2' , 'P1'),
 ( 'V2', 'Killim', 699.50, 0.25, 'C3', 'P1'),
 ( 'V3', 'Killim', 475, 0.10, 'C2', 'P3'),
  ( 'V4', 'Alfombra', 1500, 0.5 ,'C7' , 'P1'),
 ( 'V5', 'Alfombra', 5000, 0.30, 'C5', 'P1'),
 ( 'V6', 'Killim', 250, 0.10, 'C9', 'P3')
GO
```


|VentasId|Producto|Precio|Descuento|Cliente|Proveedor|
|:---|:---|:---|:---|:---|:---|
|V1|Alfombra                                          |1500|0,5|C2|P1|
|V2|Killim                                            |699,5|0,25|C3|P1|
|V3|Killim                                            |475|0,1|C2|P3|
|V4|Alfombra                                          |1500|0,5|C7|P1|
|V5|Alfombra                                          |5000|0,3|C5|P1|
|V6|Killim                                            |250|0,1|C9|P3|
                                           |475|0,1|C2|P3|



<br>


We can define a column based on operations between other columns as follows :

```sql
SELECT VentasId, Producto, Precio, Descuento, 'Precio_Final' = Precio - Precio*Descuento, Cliente, Proveedor FROM Ventas
```

|VentasId|Producto|Precio|Descuento|Precio_Final|Cliente|Proveedor|
|:---|:---|:---|:---|:---|:---|:---|
|V1|Alfombra                                          |1500|0,5|750|C2|P1|
|V2|Killim                                            |699,5|0,25|524,625|C3|P1|
|V3|Killim                                            |475|0,1|427,5|C2|P3|
|V4|Alfombra                                          |1500|0,5|750|C7|P1|
|V5|Alfombra                                          |5000|0,3|3500|C5|P1|
|V6|Killim                                            |250|0,1|225|C9|P3|



<br>


# Concatenate strings from different columns

We can concatenate string form different columns as follows :
```sql
SELECT Nombre, 'Pais-Alumnos' = Pais + '-' + Ciudad FROM Alumnos
```

|Nombre|Pais-Alumnos|
|:---|:---|
|Orlando                                           |Australia-|
|Grecia                                            |Peru-Lima|
|Ismael                                            |Espa&#241;a-Madrid|
|Luis                                              |Espa&#241;a-Murcia|
|Pedro                                             |Argentina-Buenos Aires|
|Keith                                             |India-|
|Donna                                             |Germany-Berlin|
|Janet                                             |United States-California|
|Fabio                                             |Espa&#241;a-Madrid|
|Juan                                              |Espa&#241;a-Sevilla|
|Lucia                                             |Espa&#241;a-|
|Pedro                                             |Italia-Roma|
|Sergio                                            |United States-New York|



<br>


# Sorting a table by columns

We can sort a table by the values in a specific column, in ascended or descended order, as follows

```sql
SELECT*FROM Examenes ORDER BY Nota ASC
```

|ExamenID|Nota|Asignatura|AlumnoID|ProfesorID|
|:---|:---|:---|:---|:---|
|E3|4.25|Matem&#225;ticas|A1|P1|
|E4|6.50|Inglés|A7|P7|
|E1|6.70|Matem&#225;ticas|A2|P1|
|E5|7.00|Lengua|A9|P3|
|E2|8.00|F&#237;sica|A4|P2|



<br>

```sql
SELECT*FROM Examenes ORDER BY Nota DESC
```

|ExamenID|Nota|Asignatura|AlumnoID|ProfesorID|
|:---|:---|:---|:---|:---|
|E2|8.00|F&#237;sica|A4|P2|
|E5|7.00|Lengua|A9|P3|
|E1|6.70|Matem&#225;ticas|A2|P1|
|E4|6.50|Inglés|A7|P7|
|E3|4.25|Matem&#225;ticas|A1|P1|





<br>

# Minimun, Maximun, Sum, Mean, Quantiles

 

```sql
INSERT INTO dbo.Examenes
 ([ExamenID], [Nota], [Asignatura], [AlumnoID], [ProfesorID])
VALUES
  ( 'E6', 5, N'Lengua', N'A3', N'P3'),
 ( 'E7', 7, N'Inglés', N'A12', N'P7'),
 ( 'E8', 7, N'Física', N'A1', N'P2'),
   ( 'E9', 8, N'Lengua', N'A2', N'P3'),
 ( 'E10', 6.90, N'Inglés', N'A11', N'P7'),
 ( 'E11', 5.25, N'Física', N'A2', N'P2'),
   ( 'E12', 6, N'Lengua', N'A4', N'P3'),
 ( 'E13', 7.2, N'Inglés', N'A6', N'P7'),
 ( 'E14', 7.8, N'Física', N'A5', N'P2'),
   ( 'E15', 5.5, N'Lengua', N'A7', N'P3'),
 ( 'E16', 3, N'Inglés', N'A10', N'P7'),
 ( 'E17', 4, N'Física', N'A10', N'P2')
GO
```

```sql
SELECT * FROM Examenes
```

|ExamenID|Nota|Asignatura|AlumnoID|ProfesorID|
|:---|:---|:---|:---|:---|
|E1|6.70|Matem&#225;ticas|A2|P1|
|E10|6.90|Ingl&#233;s|A11|P7|
|E11|5.25|F&#237;sica|A2|P2|
|E12|6.00|Lengua|A4|P3|
|E13|7.20|Ingl&#233;s|A6|P7|
|E14|7.80|F&#237;sica|A5|P2|
|E15|5.50|Lengua|A7|P3|
|E16|3.00|Ingl&#233;s|A10|P7|
|E17|4.00|F&#237;sica|A10|P2|
|E2|8.00|F&#237;sica|A4|P2|
|E3|4.25|Matem&#225;ticas|A1|P1|
|E4|6.50|Ingl&#233;s|A7|P7|
|E5|7.00|Lengua|A9|P3|
|E6|5.00|Lengua|A3|P3|
|E7|7.00|Ingl&#233;s|A12|P7|
|E8|7.00|F&#237;sica|A1|P2|
|E9|8.00|Lengua|A2|P3|

<br>


We can get the minimum of a column as follows :

```sql
SELECT Min(Nota) as Nota_min FROM Examenes ;
```

|Nota_min|
|:---|
|3.00|



<br>

We can get the maximum of a column as follows :

```sql
SELECT Max(Nota) as Nota_max FROM Examenes ;
```

|Nota_max|
|:---|
|8.00|



<br>

We can get the mean (average) of a column as follows :

```sql
SELECT Avg(Nota) as Nota_mean FROM Examenes ;
```

|Nota_mean|
|:---|
|6.182352|




<br>

We can get the variance of a column as follows :

```sql
SELECT Var(Nota) as Nota_var FROM Examenes ;
```

|Nota_var|
|:---|
|2,1587316176470708|



<br>

We can get the standard deviation of a column as follows :

```sql
SELECT Stdev(Nota) as Nota_std FROM Examenes ;
```

|Nota_std|
|:---|
|1,4692622698643938|


<br>

We can get the quantile 0.30 of a column as follows :

```sql
SELECT TOP (1) PERCENTILE_DISC(0.30) 
WITHIN GROUP (ORDER BY Nota ASC)
OVER () AS Nota_Q30
FROM Examenes
```

|Nota_Q30|
|:---|
|5.50|

<br>

We can get the quantile 0.80 of a column as follows :

```sql
SELECT TOP (1) PERCENTILE_DISC(0.80) 
WITHIN GROUP (ORDER BY Nota ASC)
OVER () AS Nota_Q80
FROM Examenes
```

|Nota_Q80|
|:---|
|7.20|



<br>

# Group by


We can group a table by the values ​​in a column and then calculate a metric based on those groups.

We are going to see different examples.



We can get the absolute frequency of each value in  **Nombre** column in the **Alumnos** table :

```sql
SELECT Nombre, COUNT(Nombre) 
as Cantidad_Nombre
FROM Alumnos
GROUP BY Nombre
```

|Nombre|Cantidad_Nombre|
|:---|:---|
|Donna                                             |1|
|Fabio                                             |1|
|Grecia                                            |1|
|Ismael                                            |1|
|Janet                                             |1|
|Juan                                              |1|
|Keith                                             |1|
|Lucia                                             |1|
|Luis                                              |1|
|Orlando                                           |1|
|Pedro                                             |2|
|Sergio                                            |1|


<br>

 

We can get the mean, minimun, maximu and variance of **Nota** column after group **Examenes** table by **Asignatura** column :

```sql
SELECT Asignatura, AVG(Nota) as Nota_Media, MIN(Nota) as Nota_Min, MAX(Nota) as Nota_Max, VAR(Nota) as Nota_Var
INTO Tabla_Resumen
FROM Examenes
GROUP BY Asignatura;
```

```sql
SELECT * FROM Tabla_Resumen
```

|Asignatura|Nota_Media|Nota_Min|Nota_Max|Nota_Var|
|:---|:---|:---|:---|:---|
|F&#237;sica|6.410000|4.00|8.00|2,9905000000000044|
|Ingl&#233;s|6.120000|3.00|7.20|3,1069999999999993|
|Lengua|6.300000|5.00|8.00|1,4500000000000028|
|Matem&#225;ticas|5.475000|4.25|6.70|3,001250000000006|




<br>

We can get the quantile of order 0.30,  of **Nota** column after group **Examenes** table by **Asignatura** column :

```sql
SELECT DISTINCT Asignatura, PERCENTILE_CONT(0.30) 
WITHIN GROUP (ORDER BY Nota ASC) 
OVER (PARTITION BY Asignatura) as Nota_Q30
FROM Examenes
```

|Asignatura|Nota_Q30|
|:---|:---|
|F&#237;sica|5,6000000000000005|
|Ingl&#233;s|6,58|
|Lengua|5,6|
|Matem&#225;ticas|4,984999999999999|


<br>

We can get the quantile of order 0.25,  of **Nota** column after group **Examenes** table by **Asignatura** column :

```sql
SELECT DISTINCT Asignatura, PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY Nota ASC) OVER (PARTITION BY Asignatura) as Nota_Q25
INTO Tabla_Q25
FROM Examenes
```

```sql
SELECT * FROM Tabla_Q25
```

|Asignatura|Nota_Q25|
|:---|:---|
|F&#237;sica|5,25|
|Ingl&#233;s|6,5|
|Lengua|5,5|
|Matem&#225;ticas|4,8625|



<br>

We can get the quantile of order 0.50,  of **Nota** column after group **Examenes** table by **Asignatura** column :

```sql
SELECT DISTINCT Asignatura, PERCENTILE_CONT(0.50) WITHIN GROUP (ORDER BY Nota ASC) OVER (PARTITION BY Asignatura) as Nota_Q50
INTO Tabla_Q50
FROM Examenes
```

```sql
SELECT * FROM Tabla_Q50
```

|Asignatura|Nota_Q50|
|:---|:---|
|F&#237;sica|7|
|Ingl&#233;s|6,9|
|Lengua|6|
|Matem&#225;ticas|5,475|



<br>

We can get the quantile of order 0.75,  of **Nota** column after group **Examenes** table by **Asignatura** column :

```sql
SELECT DISTINCT Asignatura, PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY Nota ASC) OVER (PARTITION BY Asignatura) as Nota_Q75
INTO Tabla_Q75
FROM Examenes
```

```sql
SELECT * FROM Tabla_Q75
```

|Asignatura|Nota_Q75|
|:---|:---|
|F&#237;sica|7,8|
|Ingl&#233;s|7|
|Lengua|7|
|Matem&#225;ticas|6,0875|





<br>

We can join **Tabla_Resumen**, **Tabla_Q25**, **Tabla_Q50** y **Tabla_Q75** as follows : 

```sql
SELECT e.Asignatura, e.Nota_Media, e.Nota_Min, e.Nota_Max, e.Nota_Var, c.Nota_Q25, d.Nota_Q50, f.Nota_Q75
FROM Tabla_Resumen e
JOIN Tabla_Q25 c ON e.Asignatura = c.Asignatura
JOIN Tabla_Q50 d ON e.Asignatura = d.Asignatura
JOIN Tabla_Q75 f ON e.Asignatura = f.Asignatura;
```

|Asignatura|Nota_Media|Nota_Min|Nota_Max|Nota_Var|Nota_Q25|Nota_Q50|Nota_Q75|
|:---|:---|:---|:---|:---|---|---|---|
|F&#237;sica|6.410000|4.00|8.00|2,9905000000000044|5,25|7|7,8|
|Ingl&#233;s|6.120000|3.00|7.20|3,1069999999999993|6,5|6,9|7|
|Lengua|6.300000|5.00|8.00|1,4500000000000028|5,5|6|7|
|Matem&#225;ticas|5.475000|4.25|6.70|3,001250000000006|4,8625|5,475|6,0875|


 


<br>


## Having

We can use Having filter rows after applying Group By. Now, we are going to see several examples.

```sql
SELECT Nombre, COUNT(Nombre) as Cantidad_Nombre
FROM Alumnos
GROUP BY Nombre
```

|Nombre|Cantidad_Nombre|
|:---|:---|
|Donna                                             |1|
|Fabio                                             |1|
|Grecia                                            |1|
|Ismael                                            |1|
|Janet                                             |1|
|Juan                                              |1|
|Keith                                             |1|
|Lucia                                             |1|
|Luis                                              |1|
|Orlando                                           |1|
|Pedro                                             |2|
|Sergio                                            |1|





```sql
SELECT Nombre, COUNT(Nombre) as Cantidad_Nombre
FROM Alumnos
GROUP BY Nombre
HAVING COUNT(Nombre) > 1
```

|Nombre|Cantidad_Nombre|
|:---|:---|
|Pedro                                             |2|






<br>



```sql
SELECT Asignatura, AVG(Nota) as Nota_Media, MIN(Nota) as Nota_Min , MAX(Nota) as Nota_Max , VAR(Nota) as Nota_Var
FROM Examenes
GROUP BY Asignatura
```

|Asignatura|Nota_Media|Nota_Min|Nota_Max|Nota_Var|
|:---|:---|:---|:---|:---|
|F&#237;sica|6.410000|4.00|8.00|2,9905000000000044|
|Ingl&#233;s|6.120000|3.00|7.20|3,1069999999999993|
|Lengua|6.300000|5.00|8.00|1,4500000000000028|
|Matem&#225;ticas|5.475000|4.25|6.70|3,001250000000006|




```sql
SELECT Asignatura, AVG(Nota) as Nota_Media, MIN(Nota) as Nota_Min , MAX(Nota) as Nota_Max , VAR(Nota) as Nota_Var
FROM Examenes
GROUP BY Asignatura
HAVING AVG(Nota) > 6.2
```

|Asignatura|Nota_Media|Nota_Min|Nota_Max|Nota_Var|
|:---|:---|:---|:---|:---|
|F&#237;sica|6.410000|4.00|8.00|2,9905000000000044|
|Lengua|6.300000|5.00|8.00|1,4500000000000028|





```sql
SELECT Asignatura, AVG(Nota) as Nota_Media, MIN(Nota) as Nota_Min , MAX(Nota) as Nota_Max , VAR(Nota) as Nota_Var
FROM Examenes
GROUP BY Asignatura
HAVING Min(Nota) >= 5
```

|Asignatura|Nota_Media|Nota_Min|Nota_Max|Nota_Var|
|:---|:---|:---|:---|:---|
|Lengua|6.300000|5.00|8.00|1,4500000000000028|







<br>



 
# Join tables

## Inner Join

The inner join operation applied to two data frames  $DF_1$  and  $DF_2$   produces another data frame consisting of the union of the rows of $DF_1$  and  $DF_2$   that share the same value in the link column (share the same linking value).

 
```sql
SELECT a.Nombre, b.Asignatura , b.Nota
FROM Alumnos a
JOIN Examenes b 
ON a.AlumnoID = b.AlumnoID
```

|Nombre|Asignatura|Nota|
|:---|:---|:---|
|Keith                                             |Matem&#225;ticas|6.70|
|Ismael                                            |Ingl&#233;s|6.90|
|Keith                                             |F&#237;sica|5.25|
|Janet                                             |Lengua|6.00|
|Juan                                              |Ingl&#233;s|7.20|
|Fabio                                             |F&#237;sica|7.80|
|Lucia                                             |Lengua|5.50|
|Grecia                                            |Ingl&#233;s|3.00|
|Grecia                                            |F&#237;sica|4.00|
|Janet                                             |F&#237;sica|8.00|
|Orlando                                           |Matem&#225;ticas|4.25|
|Lucia                                             |Ingl&#233;s|6.50|
|Sergio                                            |Lengua|7.00|
|Donna                                             |Lengua|5.00|
|Luis                                              |Ingl&#233;s|7.00|
|Orlando                                           |F&#237;sica|7.00|
|Keith                                             |Lengua|8.00|


<br>


```sql
SELECT a.Nombre, b.Asignatura , a.email
FROM Profesores a
JOIN Examenes b 
ON a.ProfesorID = b.ProfesorID
```

|Nombre|Asignatura|email|
|:---|:---|:---|
|Juan|Matem&#225;ticas|JuanPerez@colegio.es|
|Garazi|Ingl&#233;s|GaraziGarcia@colegio.es|
|Sonia|F&#237;sica|SoniDiaz@colegio.es|
|Lucia|Lengua|LuciaPerez@colegio.es|
|Garazi|Ingl&#233;s|GaraziGarcia@colegio.es|
|Sonia|F&#237;sica|SoniDiaz@colegio.es|
|Lucia|Lengua|LuciaPerez@colegio.es|
|Garazi|Ingl&#233;s|GaraziGarcia@colegio.es|
|Sonia|F&#237;sica|SoniDiaz@colegio.es|
|Sonia|F&#237;sica|SoniDiaz@colegio.es|
|Juan|Matem&#225;ticas|JuanPerez@colegio.es|
|Garazi|Ingl&#233;s|GaraziGarcia@colegio.es|
|Lucia|Lengua|LuciaPerez@colegio.es|
|Lucia|Lengua|LuciaPerez@colegio.es|
|Garazi|Ingl&#233;s|GaraziGarcia@colegio.es|
|Sonia|F&#237;sica|SoniDiaz@colegio.es|
|Lucia|Lengua|LuciaPerez@colegio.es|


<br>

<br>


## Outer Join

The outer join operation applied to two data frames $DF_1$ and $DF_2$
  produces the same data frame of inner join, but adding the rows from  
$DF_1$  that don't share linking value with any row from   $DF_2$ , and the rows from  $DF_2$  that don't share linking value with any row form $DF_1$ .

```sql
SELECT a.Nombre, b.Asignatura , a.Estudios, a.email, b.AlumnoID, b.Nota
FROM Profesores a
FULL OUTER JOIN Examenes b 
ON a.ProfesorID = b.ProfesorID
```

|Nombre|Asignatura|Estudios|email|AlumnoID|Nota|
|:---|:---|:---|:---|:---|:---|
|Juan|Matem&#225;ticas|Matem&#225;ticas|JuanPerez@colegio.es|A2|6.70|
|Juan|Matem&#225;ticas|Matem&#225;ticas|JuanPerez@colegio.es|A1|4.25|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|A2|5.25|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|A5|7.80|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|A10|4.00|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|A4|8.00|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|A1|7.00|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|A4|6.00|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|A7|5.50|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|A9|7.00|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|A3|5.00|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|A2|8.00|
|Marcos|NULL|Biolog&#237;a|MarcosSanz@colegio.es|NULL|NULL|
|Carlos|NULL|Educaci&#243;n F&#237;sica|CarlosFernandez@colegio.es|NULL|NULL|
|Daniel|NULL|Geograf&#237;a|DanielOrtiz@colegio.es|NULL|NULL|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|A11|6.90|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|A6|7.20|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|A10|3.00|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|A7|6.50|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|A12|7.00|


<br>


```sql
SELECT DISTINCT a.Nombre, b.Asignatura , a.Estudios, a.email
FROM Profesores a
FULL OUTER JOIN Examenes b 
ON a.ProfesorID = b.ProfesorID
```

|Nombre|Asignatura|Estudios|email|
|:---|:---|:---|:---|
|Carlos|NULL|Educaci&#243;n F&#237;sica|CarlosFernandez@colegio.es|
|Daniel|NULL|Geograf&#237;a|DanielOrtiz@colegio.es|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|
|Juan|Matem&#225;ticas|Matem&#225;ticas|JuanPerez@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|
|Marcos|NULL|Biolog&#237;a|MarcosSanz@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|

<br>

<br>


## Right Join

The right join operation applied to two data frames  $DF_1$  and $DF_2$
  produces another data frame consisting of the rows of  $DF_1$ and $DF_2$
  that share link value, and the rest rows of  $DF_2$ .
  
```sql
SELECT a.Nombre, b.Asignatura , a.Estudios, a.email
FROM Profesores a
RIGHT JOIN Examenes b 
ON a.ProfesorID = b.ProfesorID
```

|Nombre|Asignatura|Estudios|email|
|:---|:---|:---|:---|
|Juan|Matem&#225;ticas|Matem&#225;ticas|JuanPerez@colegio.es|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|
|Juan|Matem&#225;ticas|Matem&#225;ticas|JuanPerez@colegio.es|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|



<br>


```sql
SELECT DISTINCT a.Nombre, b.Asignatura , a.Estudios, a.email
FROM Profesores a
RIGHT JOIN Examenes b 
ON a.ProfesorID = b.ProfesorID
```

|Nombre|Asignatura|Estudios|email|
|:---|:---|:---|:---|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|
|Juan|Matem&#225;ticas|Matem&#225;ticas|JuanPerez@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|




<br>


```sql
SELECT a.Nombre, b.Asignatura, b.Nota, a.email
FROM Alumnos a
RIGHT JOIN Examenes b 
ON a.AlumnoID = b.AlumnoID
```

|Nombre|Asignatura|Nota|email|
|:---|:---|:---|:---|
|Keith                                             |Matem&#225;ticas|6.70|keith0@adventure-works.com|
|Ismael                                            |Ingl&#233;s|6.90|Isma98@gmail.com|
|Keith                                             |F&#237;sica|5.25|keith0@adventure-works.com|
|Janet                                             |Lengua|6.00|janet1@adventure-works.com|
|Juan                                              |Ingl&#233;s|7.20||
|Fabio                                             |F&#237;sica|7.80|fabio10@gmail.com|
|Lucia                                             |Lengua|5.50|LuciaPerez@hotmail.com|
|Grecia                                            |Ingl&#233;s|3.00|Grecia89@gmail.com|
|Grecia                                            |F&#237;sica|4.00|Grecia89@gmail.com|
|Janet                                             |F&#237;sica|8.00|janet1@adventure-works.com|
|Orlando                                           |Matem&#225;ticas|4.25||
|Lucia                                             |Ingl&#233;s|6.50|LuciaPerez@hotmail.com|
|Sergio                                            |Lengua|7.00|sergio_as@gmail.com|
|Donna                                             |Lengua|5.00|donna0@adventure-works.com|
|Luis                                              |Ingl&#233;s|7.00|Luismiguel123@gmail.com|
|Orlando                                           |F&#237;sica|7.00||
|Keith                                             |Lengua|8.00|keith0@adventure-works.com|


<br>

<br>

## Left Join

The left join operation applied to two data frames  $DF_1$   and $DF_2$   produces another data frame consisting of the rows of  $DF_1$ and $DF_2$
  that share link value, and the rest rows of  $DF_1$ .


```sql
SELECT a.Nombre, b.Asignatura, b.Nota, a.email, a.AlumnoID
FROM Alumnos a
LEFT JOIN Examenes b 
ON a.AlumnoID = b.AlumnoID
```

|Nombre|Asignatura|Nota|email|AlumnoID|
|:---|:---|:---|:---|:---|
|Orlando                                           |Matem&#225;ticas|4.25||A1|
|Orlando                                           |F&#237;sica|7.00||A1|
|Grecia                                            |Ingl&#233;s|3.00|Grecia89@gmail.com|A10|
|Grecia                                            |F&#237;sica|4.00|Grecia89@gmail.com|A10|
|Ismael                                            |Ingl&#233;s|6.90|Isma98@gmail.com|A11|
|Luis                                              |Ingl&#233;s|7.00|Luismiguel123@gmail.com|A12|
|Pedro                                             |NULL|NULL|Pedro120@gmail.com|A13|
|Keith                                             |Matem&#225;ticas|6.70|keith0@adventure-works.com|A2|
|Keith                                             |F&#237;sica|5.25|keith0@adventure-works.com|A2|
|Keith                                             |Lengua|8.00|keith0@adventure-works.com|A2|
|Donna                                             |Lengua|5.00|donna0@adventure-works.com|A3|
|Janet                                             |Lengua|6.00|janet1@adventure-works.com|A4|
|Janet                                             |F&#237;sica|8.00|janet1@adventure-works.com|A4|
|Fabio                                             |F&#237;sica|7.80|fabio10@gmail.com|A5|
|Juan                                              |Ingl&#233;s|7.20||A6|
|Lucia                                             |Lengua|5.50|LuciaPerez@hotmail.com|A7|
|Lucia                                             |Ingl&#233;s|6.50|LuciaPerez@hotmail.com|A7|
|Pedro                                             |NULL|NULL|Pedro99@gmail.com|A8|
|Sergio                                            |Lengua|7.00|sergio_as@gmail.com|A9|

<br>


```sql
SELECT a.Nombre, b.Asignatura , a.Estudios, a.email
FROM Profesores a
LEFT JOIN Examenes b 
ON a.ProfesorID = b.ProfesorID
```

|Nombre|Asignatura|Estudios|email|
|:---|:---|:---|:---|
|Juan|Matem&#225;ticas|Matem&#225;ticas|JuanPerez@colegio.es|
|Juan|Matem&#225;ticas|Matem&#225;ticas|JuanPerez@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|
|Marcos|NULL|Biolog&#237;a|MarcosSanz@colegio.es|
|Carlos|NULL|Educaci&#243;n F&#237;sica|CarlosFernandez@colegio.es|
|Daniel|NULL|Geograf&#237;a|DanielOrtiz@colegio.es|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|



<br>


```sql
SELECT DISTINCT a.Nombre, b.Asignatura , a.Estudios, a.email
FROM Profesores a
LEFT JOIN Examenes b 
ON a.ProfesorID = b.ProfesorID
```


|Nombre|Asignatura|Estudios|email|
|:---|:---|:---|:---|
|Carlos|NULL|Educaci&#243;n F&#237;sica|CarlosFernandez@colegio.es|
|Daniel|NULL|Geograf&#237;a|DanielOrtiz@colegio.es|
|Garazi|Ingl&#233;s|Ingl&#233;s|GaraziGarcia@colegio.es|
|Juan|Matem&#225;ticas|Matem&#225;ticas|JuanPerez@colegio.es|
|Lucia|Lengua|Lengua|LuciaPerez@colegio.es|
|Marcos|NULL|Biolog&#237;a|MarcosSanz@colegio.es|
|Sonia|F&#237;sica|F&#237;sica|SoniDiaz@colegio.es|


<br>


# Bibliography

- Microsoft. (2021). Get Started Querying with Transact-SQL. https://learn.microsoft.com/es-es/training/paths/get-started-querying-with-transact-sql/


<br>


